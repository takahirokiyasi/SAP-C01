# ENI (Elastic Network Interface)
IPアドレス・MACアドレス・セキュリティグループなどの属性を保持できる
## ENI プール

## ENIでEC2に複数のSSL証明書を処理
1つのEC2インスタンスに複数のENI（Elastic Network Interface）を接続することで対応ができます。ENIは、仮想ネットワークカードを表すVPCの論理ネットワークコンポーネントであり、このシナリオでは、2つのENIをオンデマンドEC2インスタンスに接続して、2つのSSLを処理できるようにすること

# インターリージョンVPCピアリング
Gateway、VPNコネクション、ネットワークアプライアンスなどを使う事なく、  
別のリージョンで稼働しているEC2インスタンス、RDSデータベース、LambdaファンクションなどのVPCリソースに対してPrivate IPアドレスにて通信が可能

# VPN
# SSL-VPN
既存のVPCのパブリックサブネットにSSL-VPNサーバーを構築する。既存のシステムをプライベートサブネットに配置することによってSSL-VPNサーバーを介して外部インターネットから利用することができる。
SSLを利用してセッション層で実装されるVPN

# IPsec-VPN
ネットワーク層で実装されるVPN
リモートアクセスにも活用できるが、ユーザー認証方法・NAPTの仕様・接続先情報の取得方法などに問題があり、実用的ではない。

SSL-VPNなら外部からのリモートアクセス、IPSec VPNなら組織間アクセスという利用方法の違いがある。

- Site-to-Site VPN 接続は、AWS Classic VPN または AWS VPN のいずれかです。
- IPSecトンネル経由で送信されるデータの整合性を保持する。
- IPSecトンネルを経由して送信されるデータは暗号化される。
- IPSecはインターネット経由で送信中のデータを保護する。
- IPSecトンネルのセットアップ中にIDが認証される。
- VPNゲートウェイ（VPG）とカスタマーゲートウェイ（CGW）の間にIPSecトンネルが確立される。

## VPNの可用性を高める
新しく別のカスタマーゲートウェイを導入して、別のデュアルトンネルVPN接続を追加でもう１つ設定します。AWS でデバイス障害が発生した場合、VPN 接続は自動的に 2 番目のトンネルにフェールオーバーして、アクセスが中断されないようにする。

## AWS Site-to-Site VPN
デフォルトでは、Amazon VPC内に起動されるインスタンスと顧客独自の (リモート) ネットワークとの通信はできない。VPCからリモートネットワークへのアクセスを有効にするには、AWS Site-to-Site VPN (Site-to-Site VPN) 接続を作成し、接続を経由してトラフィックを渡すようにルーティングを設定する。
IPsec VPNをサポート

### AWS CloudHub
複数のAWS Site-to-Site VPN接続がある場合にvpcとリモートネットワーク間の通信だけでなくリモート間の通信を可能にする


# Direct Connect
オンプレミスから AWS への専用ネットワーク接続の構築するもの。
標準のイーサネット光ファイバケーブルを介して接続するサービス
間にAWS Direct Connect ロケーションと言う
AWS とデータセンター、オフィス、またはコロケーション環境との間にプライベート接続を確立することができます。これにより、多くの場合、ネットワークのコストを削減し、帯域幅のスループットを向上させ、インターネットベースの接続よりも安定した接続をすることができる。

VPCからオンプレミス環境へ疎通するためにはVPCのルートテーブルに、オンプレミス環境側のネットワークへのルート情報が登録されている必要がある。
仮装インターフェイスを稼働状態にするために、802.1 Q VLANに対してVLANトランキングの有効化が必要
VPCのVGW(virtual private gateway)に対して、ルートプロパゲーションを有効化する。

## Direct Connect Gateway
仮想インターフェース(以下VIF)とVPCの仮想プライベートゲートウェイ(以下VGW)の間に追加する新たなコンポーネントで複数リージョンに対してDirect Connectできる
- Direct Connect GatewayをいずれかのAWSリージョンに作成すると、AWSの全リージョンに複製され、相互接続できる
- Direct Connect Gatewayには複数のVIFおよびVGWが接続できる

`※時間あたりの料金が必要なので料金が高い`  
direct connectを一つのリージョンにしてリージョン間VPCピアリングした場合の方が通信量に対して料金がかかるだけなので安い。

Direct Connect と VPNは同じVGWを使用することができる。

https://dev.classmethod.jp/articles/direct-connect-gateway/

## VGW(仮想プライベートゲートウェイ)
プライベート仮想インターフェイスを介して、AWS Direct Connect 接続を、同じリージョンまたは異なるリージョンに配置されたアカウントの1つ以上のVPCに接続できる。

## VIF（仮想インターフェイス）


# CGW（カスタマーゲートウェイ）
VPCとオンプレミス環境間でVPN接続を確立する際に必要になる。

オンプレ側のルーターのパブリックIPが設定値として必要（VPNにおいてのオンプレ側の終点の設定）

# Transit Gateway
AWS Transit Gateway を利用して、多数のVPCを管理することができます。AWS Transit Gateway を使用すれば、中央のゲートウェイからネットワーク上にある Amazon VPC、オンプレミスのデータセンター、リモートオフィスそれぞれに単一の接続を構築して管理するのみでよいのです。Transit Gateway がハブの役割を果たし、トラフィックがスポークのように接続されたネットワーク間をどのようにルーティングするか等をすべて制御します。

AWS Transit Gateway では統計とログが提供されます。これらは、Amazon CloudWatch や Amazon VPC フローログなどのサービスで使用されます。Amazon CloudWatch を使用して、Amazon VPC と VPN 接続間の帯域幅の使用量、パケットフロー数、パケットドロップ数を取得できます。また、AWS Transit Gateway で Amazon VPC フローログを有効にできるため、AWS Transit Gateway を使用してルーティングされた IP トラフィックに関する情報を取得できます

また、トランジットゲートウェイをファイアウォールまたは IPS（侵入防止システム）に接続したり、ネットワークのすべての入出力トラフィックを処理する単一の VPC を作成することもできます。

## Transit Gateway network manager
AWS Transit Gateway network manager は、ネットワークトポロジーの変更、ルーティングの更新、接続ステータスの更新に関する組み込みのイベント通知を提供します。

# VPC
## IPアドレス枯渇
最大4つのセカンダリーCIDRブロックを関連付けてVPCに追加することにより、ネットワークをさらに拡張することができる。

## DHCP オプション
一度DHCPオプションのセットを作成すると、それらを変更できないため、 DHCPオプションの新しいセットを作成し、VPCに関連付ける必要がある。
新しいDHCPオプションを作成して、 domain-name-servers=AmazonProvidedDNS を指定してVPCに関連付けを実施することで、エラーを回避することができる。

# VPC ピアリング
異なるVPC同士で利用しているCIDRレンジが重複すると接続を確立できない。両方とも10.0.0.0/16の時など

## 推移的なピアリング接続をサポートしない
AとB間・BとC間がピアリングされている場合、AからBを経由してCにアクセスする通信はVPCピアリングではできない
A・C間でVPCピアリング（フルメッシュ設定）するかTransit VPCかTransit gatewayを使う（Transit　gatewayの方が管理が楽で、多機能）

# Egress Only インターネットゲートウェイ
送信専用のインターネットゲートウェイ
IPv6アドレスはグローバルに一意であるため、デフォルトではパブリックアドレスになっている。
インスタンスがインターネットにアクセスできるようにしたいが、インターネット上のリソースがインスタンスとの通信をしたくない場合は、Egress-Only インターネットゲートウェイを使用できる。

# ELB
## CLB
### クロスゾーン負荷分散
Classic Load Balancer の各ロードバランサーノードは、有効なすべてのアベイラビリティーゾーンに登録されたインスタンスにリクエストを均等に分散します。クロスゾーン負荷分散が無効の場合は、各ロードバランサーノードは、そのアベイラビリティーゾーンの登録されたインスタンスにのみリクエストを均等に分散します。

クライアントが DNS ルックアップをキャッシュする環境では、着信リクエストがいずれかのアベイラビリティーゾーンを優先する場合がある。そのためクロスゾーン負荷分散を有効にする必要がある。

### TCP　UDPのプロトコル
TCPはCLBとNLBがサポートしている
ALBはHTTPとHTTPSのみ

# Route 53
## ホストゾーン
ホストゾーンはレコードのコンテナであり、レコードには example.com やそのサブドメイン (acme.example.com や zenith.example.com) の特定のドメインのトラフィックをどのようにルーティングするかに関する情報を保持

### パブリックホストゾーン
パブリックホストゾーンはインターネット上に公開されたDNSにメインレコードを管理するコンテナです。また、インターネットのDNSドメインに対するトラフィックのルーティング方法を定義するものです。
### プライベートホストゾーン
プライベートホストゾーンはVPCに閉じたプライベートネットワーク内のドメインのレコードを管理するコンテナ
#### 
プライベートホストゾーンを使用するには、次の Amazon VPC 設定を true に設定する必要があります。
enableDnsHostnames
enableDnsSupport

# CloudFront
全てのTTLを0に設定することで、コンテンツは変更されるとすぐにオリジンから配信することができる。

## 署名つきURL・Cookie
URLとCookieではほとんど同じ機能を提供している。

## 地域制限 (地理的ブロッキング) 
地域制限 (地理的ブロッキング) を使用すると、CloudFront ウェブディストリビューションを通じて配信しているコンテンツについて、特定地域のユーザーによるアクセスを回避できる。

## Origin Protocol Policy
カスタムオリジンと通信するプロトコルを決めるオプション
- Http Only
- Https Only
- Mathc

## Viewer Protocol Policy
ビューワーと通信するプロトコルを決めるオプション
- http redirect https
- http and https
- https only

